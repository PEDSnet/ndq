<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Data Cycle Changes — check_dc • ndq</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Cycle Changes — check_dc"><meta name="description" content="This function will compute row &amp;amp; patient counts in the specified tables for both
the current data model version and a previous data model version in order to
assess changes across data extractions. If you have previously executed this function,
you have the option to point to a previous result set instead of recomputing the
counts from the CDM."><meta property="og:description" content="This function will compute row &amp;amp; patient counts in the specified tables for both
the current data model version and a previous data model version in order to
assess changes across data extractions. If you have previously executed this function,
you have the option to point to a previous result set instead of recomputing the
counts from the CDM."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ndq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/database_connection.html">Database Connection &amp; Environment Setup</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PEDSnet/ndq/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Cycle Changes</h1>
      <small class="dont-index">Source: <a href="https://github.com/PEDSnet/ndq/blob/main/R/data_cycle_changes.R" class="external-link"><code>R/data_cycle_changes.R</code></a></small>
      <div class="d-none name"><code>check_dc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function will compute row &amp; patient counts in the specified tables for both
the current data model version and a previous data model version in order to
assess changes across data extractions. If you have previously executed this function,
you have the option to point to a previous result set instead of recomputing the
counts from the CDM.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_dc</span><span class="op">(</span></span>
<span>  <span class="va">dc_tbl</span>,</span>
<span>  omop_or_pcornet <span class="op">=</span> <span class="st">"omop"</span>,</span>
<span>  prev_db_string <span class="op">=</span> <span class="st">"v1"</span>,</span>
<span>  current_db_string <span class="op">=</span> <span class="st">"v2"</span>,</span>
<span>  prev_ct_src <span class="op">=</span> <span class="st">"cdm"</span>,</span>
<span>  prev_db <span class="op">=</span> <span class="fu">config</span><span class="op">(</span><span class="st">"db_src"</span><span class="op">)</span>,</span>
<span>  prev_rslt_tbl <span class="op">=</span> <span class="st">"dc_output"</span>,</span>
<span>  prev_rslt_schema <span class="op">=</span> <span class="fu">config</span><span class="op">(</span><span class="st">"results_schema"</span><span class="op">)</span>,</span>
<span>  check_string <span class="op">=</span> <span class="st">"dc"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dc-tbl">dc_tbl<a class="anchor" aria-label="anchor" href="#arg-dc-tbl"></a></dt>
<dd><p><em>tabular input</em> || <strong>required</strong></p>
<p>The primary input table that contains descriptive information about the checks
to be executed by the function. It should include definitions for the CDM elements
that should be compared between the current and previous data model versions.
see <code><a href="dc_input_omop.html">?dc_input_omop</a></code> or <code><a href="dc_input_pcornet.html">?dc_input_pcornet</a></code> for examples of the input structure</p></dd>


<dt id="arg-omop-or-pcornet">omop_or_pcornet<a class="anchor" aria-label="anchor" href="#arg-omop-or-pcornet"></a></dt>
<dd><p><em>string</em> || defaults to <code>omop</code></p>
<p>A string, either <code>omop</code> or <code>pcornet</code>, indicating the CDM format of the data</p></dd>


<dt id="arg-prev-db-string">prev_db_string<a class="anchor" aria-label="anchor" href="#arg-prev-db-string"></a></dt>
<dd><p><em>string</em> || defaults to <code>v1</code></p>
<p>A string label indicating the previous CDM version</p>
<p>If <code>prev_ct_src</code> is set to <code>result</code>, make sure this matches the appropriate database
label in the last set of results</p></dd>


<dt id="arg-current-db-string">current_db_string<a class="anchor" aria-label="anchor" href="#arg-current-db-string"></a></dt>
<dd><p><em>string</em> || defaults to <code>v2</code></p>
<p>A string label indicating the current CDM version</p></dd>


<dt id="arg-prev-ct-src">prev_ct_src<a class="anchor" aria-label="anchor" href="#arg-prev-ct-src"></a></dt>
<dd><p><em>string</em> || defaults to <code>cdm</code></p>
<p>A string indicating the source from which  the counts from the previous data model
should be extracted:</p><ul><li><p><code>cdm</code> will compute the counts based on the previous CDM tables</p></li>
<li><p><code>result</code> will pull existing counts from a previous instance of <code>check_dc</code> output</p></li>
</ul></dd>


<dt id="arg-prev-db">prev_db<a class="anchor" aria-label="anchor" href="#arg-prev-db"></a></dt>
<dd><p><em>database connection</em> || defaults to <code>config('db_src')</code></p>
<p>A database connection object that will connect the function to the
previous CDM instance or the defined result table</p></dd>


<dt id="arg-prev-rslt-tbl">prev_rslt_tbl<a class="anchor" aria-label="anchor" href="#arg-prev-rslt-tbl"></a></dt>
<dd><p><em>string</em> || defaults to <code>dc_output</code></p>
<p>If <code>prev_ct_src</code> is set to <code>result</code>, this string should reflect name of
the table where previous results are stored on the database</p></dd>


<dt id="arg-prev-rslt-schema">prev_rslt_schema<a class="anchor" aria-label="anchor" href="#arg-prev-rslt-schema"></a></dt>
<dd><p><em>string</em> || defaults to <code>config('results_schema')</code></p>
<p>If <code>prev_ct_src</code> is set to <code>result</code>, this string should reflect name of
the schema where previous results are stored on the database</p></dd>


<dt id="arg-check-string">check_string<a class="anchor" aria-label="anchor" href="#arg-check-string"></a></dt>
<dd><p><em>string</em> || defaults to <code>dc</code></p>
<p>An abbreviated identifier that will be used to label all output from this module</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function will return a list with two dataframes:</p><ul><li><p><code>dc_cts</code>: A table containing the row and (where applicable) person counts for each CDM
element specified by the user</p></li>
<li><p><code>dc_meta</code>: A table containing the metadata associated with each check that appears in <code>dc_cts</code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># First create input file with desired checks to be executed</span></span></span>
<span class="r-in"><span><span class="co"># You can access examples for both OMOP &amp; PCORnet here:</span></span></span>
<span class="r-in"><span><span class="fu">ndq</span><span class="fu">::</span><span class="va"><a href="dc_input_omop.html">dc_input_omop</a></span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 26 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    schema_current table_current schema_prev table_prev filter_logic check_domain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> cdm            person        cdm         person     <span style="color: #BB0000;">NA</span>           person      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> cdm            drug_exposure cdm         drug_expo… <span style="color: #BB0000;">NA</span>           drug_exposu…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> cdm            condition_oc… cdm         condition… <span style="color: #BB0000;">NA</span>           condition_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> cdm            device_expos… cdm         device_ex… <span style="color: #BB0000;">NA</span>           device_expo…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> cdm            visit_occurr… cdm         visit_occ… <span style="color: #BB0000;">NA</span>           visit_occur…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> cdm            condition_oc… cdm         condition… condition_t… condition_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> cdm            condition_oc… cdm         condition… condition_t… condition_i…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> cdm            condition_oc… cdm         condition… condition_t… condition_ed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> cdm            condition_oc… cdm         condition… condition_t… condition_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> cdm            condition_oc… cdm         condition… condition_t… condition_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 16 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: check_id &lt;chr&gt;, check_description &lt;chr&gt;</span></span>
<span class="r-in"><span><span class="fu">ndq</span><span class="fu">::</span><span class="va"><a href="dc_input_pcornet.html">dc_input_pcornet</a></span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 22 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    schema_current table_current schema_prev table_prev filter_logic check_domain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> cdm            demographic   cdm         demograph… <span style="color: #BB0000;">NA</span>           person      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> cdm            diagnosis     cdm         diagnosis  <span style="color: #BB0000;">NA</span>           diagnosis   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> cdm            encounter     cdm         encounter  <span style="color: #BB0000;">NA</span>           encounter   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_i…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_ed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_o…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_i…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> cdm            diagnosis     cdm         diagnosis  enc_type %i… diagnosis_i…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 12 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: check_id &lt;chr&gt;, check_description &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use this as your input to the DC function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If you would like to retrieve counts from a previous CDM instance,</span></span></span>
<span class="r-in"><span><span class="co">## configure the function like so:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">my_dc_rslt</span> <span class="op">&lt;-</span> <span class="fu">check_dc</span><span class="op">(</span>dc_tbl <span class="op">=</span> <span class="fu">ndq</span><span class="fu">::</span><span class="va"><a href="dc_input_omop.html">dc_input_omop</a></span>,</span></span>
<span class="r-in"><span>                       omop_or_pcornet <span class="op">=</span> <span class="st">'omop'</span>,</span></span>
<span class="r-in"><span>                       prev_db_string <span class="op">=</span> <span class="st">'my_previous_data'</span>,</span></span>
<span class="r-in"><span>                       current_db_string <span class="op">=</span> <span class="st">'my_current_data'</span>,</span></span>
<span class="r-in"><span>                       prev_ct_src <span class="op">=</span> <span class="st">'cdm'</span>, <span class="co">## looking in previous CDM instance</span></span></span>
<span class="r-in"><span>                       prev_db <span class="op">=</span> <span class="va">my_prev_db_connection</span>,</span></span>
<span class="r-in"><span>                       check_string <span class="op">=</span> <span class="st">'dc'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If you would like to reference previously executed counts from a prior</span></span></span>
<span class="r-in"><span><span class="co">## run of check_dc, configure the function like so:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">my_dc_rslt</span> <span class="op">&lt;-</span> <span class="fu">check_dc</span><span class="op">(</span>dc_tbl <span class="op">=</span> <span class="fu">ndq</span><span class="fu">::</span><span class="va"><a href="dc_input_omop.html">dc_input_omop</a></span>,</span></span>
<span class="r-in"><span>                       omop_or_pcornet <span class="op">=</span> <span class="st">'omop'</span>,</span></span>
<span class="r-in"><span>                       prev_db_string <span class="op">=</span> <span class="st">'my_previous_data'</span>,</span></span>
<span class="r-in"><span>                       current_db_string <span class="op">=</span> <span class="st">'my_current_data'</span>,</span></span>
<span class="r-in"><span>                       prev_ct_src <span class="op">=</span> <span class="st">'result'</span>, <span class="co">## looking in previous results</span></span></span>
<span class="r-in"><span>                       prev_db <span class="op">=</span> <span class="va">my_prev_db_connection</span>,</span></span>
<span class="r-in"><span>                       prev_rslt_tbl <span class="op">=</span> <span class="st">'my_dc_rslt'</span>,</span></span>
<span class="r-in"><span>                       prev_rslt_schema <span class="op">=</span> <span class="st">'my_previous_schema'</span>,</span></span>
<span class="r-in"><span>                       check_string <span class="op">=</span> <span class="st">'dc'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hanieh Razzaghi, Kimberley Dickinson, Kaleigh Wieand, Charles Bailey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

